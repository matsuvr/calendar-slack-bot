steps:
  # ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰
  - name: 'gcr.io/cloud-builders/docker'
    args: ['build', '-t', 'gcr.io/$PROJECT_ID/calendar-slack-bot', '.']
  
  # ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’Container Registryã«ãƒ—ãƒƒã‚·ãƒ¥
  - name: 'gcr.io/cloud-builders/docker'
    args: ['push', 'gcr.io/$PROJECT_ID/calendar-slack-bot']
    # ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’Cloud Runã«ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆğŸš€ é«˜é€ŸåŒ–è¨­å®šï¼‰
  - name: 'gcr.io/google.com/cloudsdktool/cloud-sdk'
    entrypoint: gcloud
    args:
      - 'run'
      - 'deploy'
      - 'calendar-slack-bot'
      - '--image=gcr.io/$PROJECT_ID/calendar-slack-bot'
      - '--region=us-central1'
      - '--platform=managed'
      - '--allow-unauthenticated'
      # ğŸš€ é«˜é€ŸåŒ–: ãƒªã‚½ãƒ¼ã‚¹è¨­å®š
      - '--memory=1Gi'
      - '--cpu=2'
      - '--concurrency=100'
      - '--max-instances=10'
      # ğŸš€ é«˜é€ŸåŒ–: ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®š
      - '--timeout=300'
      # ğŸš€ é«˜é€ŸåŒ–: ã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆè»½æ¸›ï¼ˆæœ‰æ–™æ©Ÿèƒ½ã ãŒå‚è€ƒã¨ã—ã¦ï¼‰
      # - '--min-instances=1'  # 1ã¤ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’å¸¸æ™‚èµ·å‹•ï¼ˆç„¡æ–™æ ã§ã¯ä½¿ç”¨ä¸å¯ï¼‰

# Cloud Loggingã‚’ä½¿ç”¨ã—ã¦ã‚¨ãƒ©ãƒ¼ã‚’è§£æ±º
options:
  logging: CLOUD_LOGGING_ONLY

images:
  - 'gcr.io/$PROJECT_ID/calendar-slack-bot'